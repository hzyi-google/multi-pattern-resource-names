# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

module Grafeas
  module V1beta1
    module Vulnerability
      # Vulnerability provides metadata about a security vulnerability.
      # @!attribute [rw] cvss_score
      #   @return [Float]
      #     The CVSS score for this vulnerability.
      # @!attribute [rw] severity
      #   @return [Grafeas::V1beta1::Vulnerability::Severity]
      #     Note provider assigned impact of the vulnerability.
      # @!attribute [rw] details
      #   @return [Array<Grafeas::V1beta1::Vulnerability::Vulnerability::Detail>]
      #     All information about the package to specifically identify this
      #     vulnerability. One entry per (version range and cpe_uri) the package
      #     vulnerability has manifested in.
      class Vulnerability
        # Identifies all occurrences of this vulnerability in the package for a
        # specific distro/location. For example: glibc in
        # cpe:/o:debian:debian_linux:8 for versions 2.1 - 2.2
        # @!attribute [rw] cpe_uri
        #   @return [String]
        #     The cpe_uri in [cpe format] (https://cpe.mitre.org/specification/) in
        #     which the vulnerability manifests.  Examples include distro or storage
        #     location for vulnerable jar.
        # @!attribute [rw] package
        #   @return [String]
        #     The name of the package where the vulnerability was found.
        # @!attribute [rw] min_affected_version
        #   @return [Grafeas::V1beta1::Package::Version]
        #     The min version of the package in which the vulnerability exists.
        # @!attribute [rw] max_affected_version
        #   @return [Grafeas::V1beta1::Package::Version]
        #     The max version of the package in which the vulnerability exists.
        # @!attribute [rw] severity_name
        #   @return [String]
        #     The severity (eg: distro assigned severity) for this vulnerability.
        # @!attribute [rw] description
        #   @return [String]
        #     A vendor-specific description of this note.
        # @!attribute [rw] fixed_location
        #   @return [Grafeas::V1beta1::Vulnerability::VulnerabilityLocation]
        #     The fix for this specific package version.
        # @!attribute [rw] package_type
        #   @return [String]
        #     The type of package; whether native or non native(ruby gems, node.js
        #     packages etc).
        # @!attribute [rw] is_obsolete
        #   @return [true, false]
        #     Whether this detail is obsolete. Occurrences are expected not to point to
        #     obsolete details.
        class Detail; end
      end

      # Details of a vulnerability occurrence.
      # @!attribute [rw] type
      #   @return [String]
      #     The type of package; whether native or non native(ruby gems, node.js
      #     packages etc)
      # @!attribute [rw] severity
      #   @return [Grafeas::V1beta1::Vulnerability::Severity]
      #     Output only. The note provider assigned Severity of the vulnerability.
      # @!attribute [rw] cvss_score
      #   @return [Float]
      #     Output only. The CVSS score of this vulnerability. CVSS score is on a
      #     scale of 0-10 where 0 indicates low severity and 10 indicates high
      #     severity.
      # @!attribute [rw] package_issue
      #   @return [Array<Grafeas::V1beta1::Vulnerability::PackageIssue>]
      #     The set of affected locations and their fixes (if available) within the
      #     associated resource.
      # @!attribute [rw] short_description
      #   @return [String]
      #     Output only. A one sentence description of this vulnerability.
      # @!attribute [rw] long_description
      #   @return [String]
      #     Output only. A detailed description of this vulnerability.
      # @!attribute [rw] related_urls
      #   @return [Array<Grafeas::V1beta1::RelatedUrl>]
      #     Output only. URLs related to this vulnerability.
      class Details; end

      # This message wraps a location affected by a vulnerability and its
      # associated fix (if one is available).
      # @!attribute [rw] affected_location
      #   @return [Grafeas::V1beta1::Vulnerability::VulnerabilityLocation]
      #     The location of the vulnerability.
      # @!attribute [rw] fixed_location
      #   @return [Grafeas::V1beta1::Vulnerability::VulnerabilityLocation]
      #     The location of the available fix for vulnerability.
      # @!attribute [rw] severity_name
      #   @return [String]
      #     The severity (e.g., distro assigned severity) for this vulnerability.
      class PackageIssue; end

      # The location of the vulnerability.
      # @!attribute [rw] cpe_uri
      #   @return [String]
      #     The cpe_uri in [cpe format] (https://cpe.mitre.org/specification/)
      #     format. Examples include distro or storage location for vulnerable jar.
      # @!attribute [rw] package
      #   @return [String]
      #     The package being described.
      # @!attribute [rw] version
      #   @return [Grafeas::V1beta1::Package::Version]
      #     The version of the package being described.
      class VulnerabilityLocation; end

      # Note provider-assigned severity/impact ranking.
      module Severity
        # Unknown.
        SEVERITY_UNSPECIFIED = 0

        # Minimal severity.
        MINIMAL = 1

        # Low severity.
        LOW = 2

        # Medium severity.
        MEDIUM = 3

        # High severity.
        HIGH = 4

        # Critical severity.
        CRITICAL = 5
      end
    end
  end
end